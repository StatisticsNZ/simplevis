---
title: "Interactive graphs"
author: "David Hodge"
date: "`r Sys.Date()`"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(simplevis)
library(tidyverse)
```

These `ggplot` graphs have been designed that users can convert them easily to html interactive objects by wrapping them in `plotly::ggplotly(plot)`. The `plotly_camera` function turns off all widgets other than the camera to make a cleaner graph.

```{r, echo = FALSE, eval = FALSE}
plot_data <- storms %>%
  group_by(year) %>%
  summarise(average_wind = mean(wind))

plot <- ggplot_vbar(data = plot_data, 
                    x_var = year, 
                    y_var = average_wind)

plotly::ggplotly(plot) %>% 
  plotly_camera() 
```

The `plotly::ggplotly` function provides the ability to convert the ggplot to an interactive object. 

```{r, message = FALSE, warning = FALSE, fig.height = 3, fig.width = 7}
plot_data <- ggplot2::diamonds %>% 
  slice_sample(prop = 0.05)

plot_data

plot <- ggplot_point(plot_data, 
                 x_var = carat, 
                 y_var = price)

plotly::ggplotly(plot) %>% 
  plotly_camera()
```

A customised tooltip can be provided using the `text_var` argument in `simplevis` functions with `plotly::ggplotly(plot, tooltip = "text")`. The `tooltip = text` argument specifies that the tooltip should be built using the text variable (i.e. `text_var`) instead of by default.

```{r, message = FALSE, warning = FALSE, fig.height = 3, fig.width = 7}
plot_data <- ggplot2::diamonds %>% 
  slice_sample(prop = 0.05)

plot_data

plot <- ggplot_point(plot_data, 
                 x_var = carat, 
                 y_var = price,
                 text_var = z)

plotly::ggplotly(plot, tooltip = "text") %>% 
   plotly_camera()
```

A column called `text` of all (or predefined) variables in the data can be built using the `mutate_text` function. Note that the column name is converted to sentence case with underscores converted to spaces.

```{r, message = FALSE, warning = FALSE, fig.height = 3, fig.width = 7}
plot_data <- ggplot2::diamonds %>% 
  slice_sample(prop = 0.05) %>% 
  mutate_text()

plot_data

plot <- ggplot_point(plot_data, 
                 x_var = carat, 
                 y_var = price,
                 text_var = text)

plotly::ggplotly(plot, tooltip = "text") %>% 
  plotly_camera()
```

A column called `text` of all (or predefined) variables in the data can be built using the `mutate_text` function. 

```{r, message = FALSE, warning = FALSE, fig.height = 3, fig.width = 7}
plot_data <- ggplot2::diamonds %>% 
  slice_sample(prop = 0.05) %>% 
  mutate_text(c("carat", "cut", "color", "clarity", "depth"))

plot_data

plot <- ggplot_point(plot_data, 
                 x_var = carat, 
                 y_var = price,
                 text_var = text)

plotly::ggplotly(plot, tooltip = "text") %>% 
  plotly_camera()
```