---
title: "Scales"
author: "David Hodge"
date: "`r Sys.Date()`"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  message = FALSE,
  warning = FALSE,
  fig.height = 3.5, 
  fig.width = 6
)
```

```{r}
library(dplyr)
library(simplevis)
library(palmerpenguins)
```

### Overview

`simplevis` uses consistent prefixes in arguments to help users to enable users to narrow down what they are looking for and then enable the Rstudio auto-complete to provide options.

In general:

* Arguments that relate to the x scale start with `x_` 
* Agruments that relate to the y scale start with `y_` 
* Arguments that relate to the colour scale start with `col_`
* Arguments that relate to facetting start with `facet_`

Therefore, if you know want to adjust the x scale but can't think how, you can start typing `x_` within the simplevis function, press tab, and then you will be presented with a lot of options. You can use the arrow keys to scroll through these, and the tab to select.

One deviation from this logic is that colour palette is selected using a `pal` argument consistently in all functions regardless of whether the colour palette relates to a colour scale or just to everything.

### Labels

You can adjust x, y or colour scale labels using `x_labels`, `y_labels` or `col_labels` arguments, and functions from the `scales` package. 

```{r}
gg_point(iris, Sepal.Width, Sepal.Length,
               y_labels = scales::number_format(accuracy = 0.01, scale = 1/100),
               y_title = "Sepal length (m)")
```

Or via a function.

```{r}
gg_point(iris, Sepal.Width, Sepal.Length,
               x_labels = function(x) glue::glue("{x}ish"))
```

Note there is a default sentence case transformation for categorical x variables.

```{r}
gg_point(penguins, sex, body_mass_g)
```

You can use `ggplot2::waiver()` to turn this off.

The `facet_labels` argument works slightly differently in that it provides access to the ggplot2 labeller argument within the ggplot `facet_wrap` function. Therefore you need to use ggplot labeller functions to modify these.

### Numeric scales

`simplevis` graphs numeric scales default to:

* starting from zero for numeric scales on bar graphs. 
* <i>not</i> starting from zero for numeric scales on all other graphs. 

You can use the `x_zero` and `y_zero` arguments to change the defaults.

```{r}
gg_point(iris, Sepal.Width, Sepal.Length,
               x_zero = FALSE, y_zero = FALSE)

```

Adjust the number of breaks for numeric x and/or y scales.

```{r}
gg_point(iris, Sepal.Width, Sepal.Length, 
               y_pretty_n = 10,
               x_pretty_n = 3)
```

Transform numeric x and y scales.

```{r}
gg_point(iris, Sepal.Width, Sepal.Length,
               x_trans = "sqrt", 
               y_trans = "log10")
```

Balance a numeric scale so that it has equivalence between positive and negative values.

```{r}
plot_data <- storms %>%
  group_by(year) %>%
  summarise(average_wind = round(mean(wind), 2)) 

gg_bar(plot_data, year, average_wind,
            y_balance = TRUE)
```

### Discrete scales

`simplevis` automatically orders hbar graphs of character variables alphabetically.

```{r}
plot_data <- ggplot2::diamonds %>%
  mutate(cut = as.character(cut)) %>% 
  group_by(cut) %>%
  summarise(average_price = mean(price)) 
  
gg_hbar(plot_data, average_price, cut)

```

Simple hbar and vbar plots that are not facetted or coloured can be ordered by size using y_reorder or x_reorder.

```{r}
plot_data <- ggplot2::diamonds %>%
  mutate(cut = as.character(cut)) %>% 
  group_by(cut) %>%
  summarise(average_price = mean(price)) 
  
gg_hbar(plot_data, average_price, cut, y_reorder = T)
```

Discrete scales can be reversed easily using the relevant `y_rev` or `x_rev` argument. 

```{r}
gg_hbar(plot_data, average_price, cut,
            y_rev = TRUE)
```

If there is an inherent order to the character variable that you want it to plot in, then you should convert the variable to a factor. 

```{r}
cut_levels <-  c("Fair", "Good", "Very Good", "Premium", "Ideal")

plot_data <- plot_data %>% 
 mutate(cut = factor(cut, levels = cut_levels)) 

gg_hbar(plot_data, average_price, cut)
```

### Colour scales

Customise the colour title. Note that because colour labels will be converted to sentence case by default in simplevis, but we can turn this off when we do not want this to occur using `ggplot2::waiver()`

```{r}
plot_data <- ggplot2::diamonds %>%
  group_by(cut, clarity) %>%
  summarise(average_price = mean(price))

gg_hbar_col(plot_data, average_price, cut, clarity, 
            col_labels = ggplot2::waiver(),
            col_title = "Diamond clarity")

```

Reverse the palette.

```{r}
gg_hbar_col(plot_data, average_price, cut, clarity,
            col_labels = ggplot2::waiver(), 
            pal_rev = TRUE)

```

Reverse the order of coloured bar pieces.

```{r}
gg_hbar_col(plot_data, average_price, cut, clarity,
            col_labels = ggplot2::waiver(), 
            col_rev = TRUE)

```

